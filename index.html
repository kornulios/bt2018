<html>

<head>
  <script src="./node_modules/axios/dist/axios.js"></script>
  <script src="js/view.js"></script>
  <script src="js/data.js"></script>
  <script src="js/result.js"></script>
  <script src="js/track.js"></script>
  <script src="js/player.js"></script>
  <script src="js/race.js"></script>
  <script src="js/championship.js"></script>
  <script src="js/game.js"></script>

  <link rel="stylesheet" href="css/style.css">

</head>

<body>
  <script>
    //main game object
    var game;

    document.addEventListener('DOMContentLoaded', function (e) {
      console.log('up and running');

      
      game = new Game();

      getData().then(function (res) {
        let players = [];
        for (let i=0; i<104; i++){
          let p = { name: "Player " + i}
          players.push(p);
        }
        // game.createChampionship(res.data.players);
        game.createChampionship(players);
        game.view.renderChampionshipView(game.championship);
      }).catch(function (err) {
        console.log('Data load failed', err);
      });

      initEvents();
      // game.view.drawOnCanvas();
    });

    function initEvents() {
      var startButton = document.getElementById('start-btn');
      startButton.addEventListener('click', startGame);
      document.getElementById('run-btn').addEventListener('click', game.startRace.bind(game));
      document.getElementById('finish-btn').addEventListener('click', game.mainScreen.bind(game));
      document.getElementById('speed-fastest').addEventListener('click', game.calculateRace.bind(game));
    }

    function startGame() {
      if (game) {
        game.nextRace();
      }
    }

  </script>
  <div class='gray-back'>
    <button id="start-btn">Next race</button>
    <button id="run-btn" class="hidden">Run</button>
    <button id="finish-btn" class="hidden">Finish</button>
    <div id="controls">
      <button>Pause</button>
      <span>Speed: </span>
      <button id="speed-normal" class="btn-ctrl">></button>
      <button id="speed-fast" class="btn-ctrl">>></button>
      <button id="speed-fastest" class="btn-ctrl">>>></button>
    </div>
  </div>
  <div id="track-info"></div>
  <div id="main-view"></div>
  <div id="results-view"></div>
  <!-- <canvas id="main-canvas"></canvas> -->
</body>

</html>